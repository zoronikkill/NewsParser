# NewsParser

## Описание проекта

**NewsParser** — это телеграм-бот и парсер, предназначенные для сбора и обработки новостей с сайта [polit74.ru](https://polit74.ru). Бот предоставляет пользователю возможность просматривать новости по категориям и временным периодам, а также получать актуальную информацию по запросу. Сервис автоматически парсит данные, сохраняет их в базу данных PostgreSQL и предоставляет их пользователю через телеграм-бот.

## Основные компоненты

### 1. **Парсер**
Парсер обрабатывает страницы сайта, извлекает заголовки, ссылки, даты публикации и категории новостей, а затем сохраняет их в базу данных. Повторное добавление новостей предотвращается с помощью уникального ограничения на ссылки.

### 2. **Телеграм-бот**
Телеграм-бот предоставляет удобный интерфейс для взаимодействия с пользователем, включая выбор категорий, фильтрацию новостей по датам и возможность задавать кастомные диапазоны времени и поиск новстей по ключевому слову.

### 3. **База данных**
База данных PostgreSQL используется для хранения новостей. Она запускается в отдельном контейнере и использует volume для сохранения данных. Благодаря этому данные остаются неизменными даже после пересборки проекта.

## Структура проекта

```
NewsParser
├── Bot
│   ├── bot.py             # Код телеграм-бота
│   ├── Dockerfile         # Dockerfile для бота
│   └── requirements.txt   # Зависимости бота
├── build.sh               # Скрипт для сборки и запуска проекта
├── db
│   └── init.sql           # SQL-скрипт для инициализации базы данных
├── docker-compose.yaml    # Docker Compose файл для запуска сервиса
├── parser
│   ├── Dockerfile         # Dockerfile для парсера
│   └── parser.py          # Код парсера
└── README.md              # Документация проекта
```

## Запуск проекта
### Предварительные шаги
1. Убедитесь, что на вашем компьютере установлены Docker и Docker Compose.
2. Склонируйте репозиторий и перейдите в него:
```bash
git clone https://github.com/zoronikkill/NewsParser.git
cd NewsParser
```
3. Создайте переменную окружения BOT_TOKEN:
```bash
export BOT_TOKEN=<Токен_вашего_бота>
```
4. Выдайте права исполнения скрипту build.sh
```bash
chmod +x build.sh
```
### Сборка и запуск

Выполните команду:
```bash
./build.sh
```

Можно посмотреть обновляющиеся логи docker compose:
```bash
docker compose logs -f
```

### Запускаемые контейнеры

При запуске проекта поднимаются три контейнера:
1. **PostgreSQL** - база данных для хранения новостей.
2. **Парсер** - выполняет сбор и обработку данных с сайта [polit74.ru](https://polit74.ru).
3. **Телеграм-бот** - интерфейс для взаимодействия с пользователем.

### DevOps
- Проект полностью контейнеризирован с использованием Docker Compose.
- Скрипт `build.sh` автоматизирует процесс сборки и развертывания.

### Сервис
В меню на выбор предоставляются варианты:
Посмотреть новости из всех категорий 
Посмотреть новости из определенной категории
Посмотреть новости, в которых встречается выбранное ключевое слово
![image](https://github.com/user-attachments/assets/c8134e5f-8223-4bb9-aa0e-2280fee235be)
![image](https://github.com/user-attachments/assets/743c9e48-4f8e-4cd1-aac2-58f4ab378bdb)
![image](https://github.com/user-attachments/assets/8a646086-10a2-4f23-8bc9-2a1ca0708dcb)
![image](https://github.com/user-attachments/assets/08e3c699-382b-400f-9adc-ee9d9819fd00)
![image](https://github.com/user-attachments/assets/8551e818-62c9-427a-a5b0-20ce7588b741)
![image](https://github.com/user-attachments/assets/45fa00ae-e268-4639-92f7-ea4b61338e47)
![image](https://github.com/user-attachments/assets/199c4707-8c05-450c-9620-a6f86b873f45)
![image](https://github.com/user-attachments/assets/9cf4a478-ea89-463b-a31f-5ff91670c09f)

![image](https://github.com/user-attachments/assets/829bce16-1e29-4025-be31-5ba66c2bcf8f)






### Хранение данных
Данные о новостях хранятся в таблице `news`, структура которой описана в `db/init.sql`:
```sql
CREATE TABLE IF NOT EXISTS news (
    id SERIAL PRIMARY KEY,
    title TEXT NOT NULL,
    date TIMESTAMP NOT NULL,
    link TEXT NOT NULL UNIQUE,
    category TEXT NOT NULL
);
```

- Используется PostgreSQL, которая запускается в отдельном контейнере.
- Данные сохраняются в volume Docker, что обеспечивает их сохранность даже при пересборке проекта.
